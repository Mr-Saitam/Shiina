const { check_path_object, isObject } = require("../utils/utilidades.js"),
				errorDB = require("../class/errorDB.js");

module.exports = {
	values: function (clave, split_object, global_object, self) {

		if(clave === false) return Promise.resolve(Object.keys(global_object[self.object_id]).map(o => global_object[self.object_id][o]))
		
	  check_path_object(clave, split_object, 'values')
	  var [...args] = clave.split(split_object)
	  var object_data = global_object[self.object_id]

		for(var key of args) {
			if(!object_data.hasOwnProperty(key)) return Promise.reject(new errorDB(`No se encontro la propiedad ${key}, base de datos: ${self.database_name}`, 'PROPIEDAD NO EXISTENTE', 'values', clave))
			if(key == args[args.length-1]) {
				if(!isObject(object_data[key])) return Promise.reject(new errorDB(`El valor de la propiedad ${key} no es un objeto, base de datos: ${self.database_name}`, 'OBJETO NO EXISTENTE', 'values', clave))
				return Promise.resolve(Object.keys(object_data[key]).map(o => object_data[key][o]))
			}
			else {
				object_data = object_data[key]
			}
		}
	}
}